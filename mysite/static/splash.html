<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Placefindr</title>
    <style>
      html {
        margin: 0;
        padding: 0;
        font-family: "ITC Avant Garde Std", sans-serif;
      }
    </style>
    <link rel="shortcut icon" type="image/x-icon" href="/static/images/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="/static/styles.css"/>
    <link rel="stylesheet" type="text/css" href="/static/fonts/ITCAvantGardeStd.css"/>
    <script type="text/javascript" src="static/client.js"></script>
  </head>
  <body>
    <p id="title">
      <img id="icon" src="/static/images/icon.png"/>
      PlaceFindr
    </p>

    <form class="mainPanel" style="max-width:50em" onsubmit="showResults(); return false;">
      <!--TODO| onsubmit-->
      <div style="width: 100%" class="Med"><fieldset style="max-width: 500px">
        <div class="Row">
          <span class="paramLabel">Please enter your location: </span>
        </div>
        <div class="Row">
          <div class="ThreeQuarters">
            <input id="locationInput" class="paramInput" type="text" required placeholder="address or ZIP code"/>
          </div>
            <div id="showMapBtnDiv" class="Quarter">
            <input type="button" class="paramInput button square lightgrey" value="Show map" onclick="showMap()">
          </div>
        </div>
      </fieldset></div>
      <div style="width: 100%" class="Small"><fieldset style="max-width: 500px">  
        <div class="Row">
          <div class="Half">
            <label class="paramLabel">What kind of place?</label>
          </div>
          <div class="Half">
            <select id="placeType" class="paramInput" multiple>
              <option value="all">All</option>
              <option value="restaurants">Restaurants</option>
              <option value="museums">Museums</option>
              <!--This is becoming harder than I imagined, since we can't just dump 70 or so options into the box & pretend it's done; even worse because Google does not describe any sort of hierarchy between these categories, unlike Yelp which has some umbrella "catch-all" categories-->
              <!--TODO-->
            </select>
          </div>
        </div>
        <div class="Row">
          <div class="Half">
            <label class="paramLabel">Max Distance (in meters):</label>
          </div>
          <div class="Half">
            <input id="distanceSelect" class="paramInput" type="number" step="10" min="0" max="50000"/>
          </div>
        </div>
        <div class="Row">
          <div class="Half">
            <label class="paramLabel">When:</label>
          </div>
          <div class="Half">
            <select id="hoursSelect" class="paramInput">
              <option value="any">Don't care</option>
              <option value="now">Open now</option>
              <!--//TODO|--><!--TODO| need to be able to choose hours-->
              <option value="17">5pm</option>
              <option value="18">6pm</option>
            </select>
          </div>
        </div>
      </fieldset></div>
      <div class="Large">
        <input type="submit" class="paramInput square lightgrey" value="Get suggestions">
      </div>
    </form>
    <script>
      var autocomplete;
      var mapService;
      function onLoad() {
        var params = decodeQueryData(getUrlQueryString());
        if (params.noheader == "1")
          document.getElementById("title").style.display = "none";
        if (params.embed == "1")
        {
          document.getElementById("showMapBtnDiv").style.display = "none";
          //TODO| check sessionStorage
        }

        autocomplete = new google.maps.places.Autocomplete(
          (document.getElementById('locationInput')),
          //{types: ['address']}
        );
        autocomplete.addListener('place_changed', getLatLng);
      }
      function showResults() {
        window.top.location.href = getResultsPageUrl(getUserInput());
      }
      function showMap() {
        //TODO| redirect to map page while preserving input fields via sessionStorage

        window.top.location.href = getResultsPageUrl({});
      }

      function getLatLng(){
        var place = autocomplete.getPlace();
        lat = place.geometry.location.lat();
        lng = place.geometry.location.lng();
      }
    </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDyDK9r0KXoy40PuvFGW3-7bUD33Rfv-fQ&libraries=places&callback=onLoad"></script>
  </body>
</html>
